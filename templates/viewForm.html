
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
    crossorigin="anonymous"
  />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"
  ></script>
  <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css">
    <title>View Data</title>
    {%load static %}
    <link rel="stylesheet" href="{% static 'css/table.css'%}">

    <style>
 

.search-container{
    display: inline-block;
  align-self: flex-end;

}
    </style>
</head>
<body>
    
   

    <div >
        <h1 style="text-align: center;">Data Table</h1>
    
        <div class="search-container">
            <div class="input-group rounded">
                <form action="{% url 'searchData' %}" method="GET" >
                    <div  class="d-flex p-2">
                        
                        <input type="search" class="form-control rounded"  name="search" id="search-content" placeholder="Search" aria-label="Search" aria-describedby="search-addon" />
                        <button type="submit"  class="input-group-text border-0" id="search-addon" >
                          <i class="fa fa-search"></i>
                        </button>
                    </div>
            </form>
              </div>
            </div>


        <table  class="styled-table" id="show-data-table">
            <thead>

                <tr >
                    <th  onclick="changePage(id=1,ajax=0,sort='id')">Id</th>
                    <th onclick="changePage(id=1,ajax=0,sort='firstname')">First Name</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='lastname')">Last Name</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='designation1')"> Designation</th>
                  
                    <th  onclick="changePage(id=1,ajax=0,sort='email')">Email</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='state')">State</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='city')">City</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='dob')">Date of Birth</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='gender')">Gender</th>
                    <th >Delete</th>
                    <th >Edit</th>

                    
    
                   
    
                </tr>
            </thead>
            <tbody>
            {% for i in data %}
            <tr >
             
                <td>{{i.id}}</td>
                <td>{{i.firstname}}</td>
                <td>{{i.lastname}}</td>
                <td>{{i.designation1}}</td>

                <td>{{i.email}}</td>
                <td>{{i.state}}</td>
                <td>{{i.city}}</td>
                <td>{{i.dob}}</td>
                <td>{{i.gender}}</td>
                <td>
                    <button class="btn btn-danger btn-sm rounded-0" type="button" data-toggle="tooltip" id="{{i.id}}" data-placement="top" title="Delete" onclick="deleteData(this.id)"><i class="fa fa-trash"></i></button></td>
                <td>  <a href="{% url 'form-edit' i.id %}"> <button class="btn btn-success btn-sm rounded-0" type="button" data-toggle="tooltip" data-placement="top" title="Edit"><i class="fa fa-edit"></i></button>
                </a>
                </td>


                
            


            
            </tr>
                {% endfor %}
            </tbody>
        
          </table>


          <div class="container d-flex align-items-center justify-content-center">
            <nav aria-label="Page navigation 
            function delete(this){
    
            }
        example">
                <ul class="pagination">
                    {% for i in range%}
                    <li class="page-item"><a class="page-link" id="{{i}}" onclick="changePage(this.id,ajax=0,sort='id')">{{i}}</a></li>
                    {% endfor %}

                </ul>
              </nav>
          </div>
      
    </div>



    <script>
         async function changePage(id,ajax,sort) {
            console.log("data")
           
            pageId=id;
            let pageData= await fetch(`http://127.0.0.1:5000/show-Data/?pageId=${pageId}&ajax=${ajax}&sort=${sort}`);

            let data= await pageData.json()
            // console.log( data['all_data'],"=================================")

           let s1=`
            
            <thead>

                <tr >
                    <th  onclick="changePage(id=1,ajax=0,sort='id')">Id</th>
                    <th onclick="changePage(id=1,ajax=0,sort='firstname')">First Name</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='lastname')">Last Name</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='designation1')"> Designation</th>
                  
                    <th  onclick="changePage(id=1,ajax=0,sort='email')">Email</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='state')">State</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='city')">City</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='dob')">Date of Birth</th>
                    <th  onclick="changePage(id=1,ajax=0,sort='gender')">Gender</th>
                    <th >Delete</th>
                    <th >Edit</th>

                    
    
                   
    
                </tr>
            </thead>
            <tbody>`
        
        
            for( i in  data['all_data']){
                console.log(i)
                var id1=data['all_data'][i]['id']
                
s1+=`
<tr >
             
    <td>${ data['all_data'][i].id}</td>
            
             <td>${ data['all_data'][i].firstname}</td>
             <td>${ data['all_data'][i].lastname}</td>
             <td>${ data['all_data'][i].designation1}</td>

             <td>${ data['all_data'][i].email}</td>
             <td>${ data['all_data'][i].state}</td>
             <td>${ data['all_data'][i].city}</td>
             <td>${ data['all_data'][i].dob}</td>
             <td>${ data['all_data'][i].gender}</td>
             <td>
                 <button class="btn btn-danger btn-sm rounded-0" type="button" data-toggle="tooltip" data-placement="top" title="Delete" id=${data['all_data'][i].id} onclick="deleteData(this.id)"><i class="fa fa-trash"></i></button></td>

                 <td>  <a  href="{% url 'form-edit' 188 %}" > <button class="btn btn-success btn-sm rounded-0" type="button" data-toggle="tooltip" data-placement="top" title="Edit"><i class="fa fa-edit"></i></button>
                </a>
                </td>

         
         </tr>

`
            } 
          
        s1+=`</tbody>`
    
        let table1=document.getElementById("show-data-table")
        // console.log(table1)
        table1.innerHTML = s1

        }
    

      async  function deleteData(id){
            console.log(id)

            if(confirm("Are you sure you want to delete this record?")){
              await  fetch(`http://127.0.0.1:5000/delete-Data/?id=${id}`)
            }
        }


        async function searchBar(x){
            // console.log("Searching",x.value)

            let data=document.getElementById("search-content").value
            console.log("Searching",data)


            await fetch(`http://127.0.0.1:5000/search/?search=${data}`)

        }
    </script>
</body>
</html>